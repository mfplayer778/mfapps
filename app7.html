<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LP耐性吸収計算君</title>
<style>
* { box-sizing: border-box; }

body {
  font-family: system-ui, -apple-system;
  background: #1e1e2f;
  color: #fff;
  margin: 0;
  padding: 8px;
}

h1 { text-align: center; font-size: 20px; margin-bottom: 6px; }
h2 { text-align: center; font-size: 16px; margin-bottom: 6px; font-weight: normal; }
.note { text-align: center; font-size: 11px; color: #ccc; margin-bottom: 10px; }

.panel {
  background: #2b2b44;
  padding: 8px;
  border-radius: 6px;
  margin-bottom: 10px;
  width: 100%;
  overflow-x: auto;
}

table {
  border-collapse: collapse;
  width: 100%;
  table-layout: fixed;
  font-size: 13px;
}

th, td {
  border: 1px solid #555;
  padding: 6px;
  text-align: center;
  vertical-align: middle;
}

.colFormula {
  width: 56px;
  min-width: 56px;
  font-weight: bold;
  white-space: nowrap;
}

input.calcInput {
  width: 100%;
  max-width: 70px;
  background: #1e1e2f;
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: 4px;
  text-align: center;
  font-size: 13px;
}

.result { color: #66ccff; font-weight: bold; }
</style>
</head>
<body>

<h1>LP耐性吸収計算君</h1>
<div class="note">
  ※計算式は精査中のため事前の吸収実験を推奨<br>
  ※②③では吸収後の目標値に対して、吸収する側／される側に必要な値の逆算が可能
</div>

<!-- LP計算 -->
<h2>LP計算</h2>
<div class="panel">
<table>
<tr>
  <th class="colFormula">計算式</th>
  <th>吸収する側</th>
  <th>吸収される側</th>
  <th>吸収後のLP</th>
</tr>
<tr>
  <td class="colFormula">①</td>
  <td><input type="number" class="calcInput" id="lp1Absorber" placeholder="数値入力"></td>
  <td><input type="number" class="calcInput" id="lp1Absorbed" placeholder="数値入力"></td>
  <td class="result" id="lp1Result">計算中</td>
</tr>
<tr>
  <td class="colFormula">②</td>
  <td><input type="number" class="calcInput" id="lp2Absorber" placeholder="数値入力"></td>
  <td class="result" id="lp2Absorbed">計算中</td>
  <td><input type="number" class="calcInput" id="lp2ResultInput" placeholder="数値入力"></td>
</tr>
<tr>
  <td class="colFormula">③</td>
  <td class="result" id="lp3Absorber">計算中</td>
  <td><input type="number" class="calcInput" id="lp3Absorbed" placeholder="数値入力"></td>
  <td><input type="number" class="calcInput" id="lp3ResultInput" placeholder="数値入力"></td>
</tr>
</table>
</div>

<!-- 耐性計算 -->
<h2>耐性計算</h2>
<div class="panel">
<table>
<tr>
  <th class="colFormula">計算式</th>
  <th>吸収する側</th>
  <th>吸収される側</th>
  <th>吸収後の耐性</th>
</tr>
<tr>
  <td class="colFormula">①</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res1Absorber" placeholder="数値入力"></td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res1Absorbed" placeholder="数値入力"></td>
  <td class="result" id="res1Result">計算中</td>
</tr>
<tr>
  <td class="colFormula">②</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2Absorber" placeholder="数値入力"></td>
  <td class="result" id="res2Absorbed">計算中</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2ResultInput" placeholder="数値入力"></td>
</tr>
<tr>
  <td class="colFormula">③</td>
  <td class="result" id="res3Absorber">計算中</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res3Absorbed" placeholder="数値入力"></td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res3ResultInput" placeholder="数値入力"></td>
</tr>
</table>
</div>

<!-- 耐性計算Ⅱ -->
<h2>耐性計算Ⅱ</h2>
<div class="panel">
<table>
<tr>
  <th class="colFormula">項目</th>
  <th>吸収する側</th>
  <th>吸収される側</th>
  <th>吸収後の耐性</th>
</tr>
<tr>
  <td class="colFormula">火耐性</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_1Absorber" placeholder="数値入力"></td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_1Absorbed" placeholder="数値入力"></td>
  <td class="result" id="res2_1Result">計算中</td>
</tr>
<tr>
  <td class="colFormula">氷耐性</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_2Absorber" placeholder="数値入力"></td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_2Absorbed" placeholder="数値入力"></td>
  <td class="result" id="res2_2Result">計算中</td>
</tr>
<tr>
  <td class="colFormula">光耐性</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_3Absorber" placeholder="数値入力"></td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_3Absorbed" placeholder="数値入力"></td>
  <td class="result" id="res2_3Result">計算中</td>
</tr>
<tr>
  <td class="colFormula">闇耐性</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_4Absorber" placeholder="数値入力"></td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_4Absorbed" placeholder="数値入力"></td>
  <td class="result" id="res2_4Result">計算中</td>
</tr>
<tr>
  <td class="colFormula">回復量</td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_5Absorber" placeholder="数値入力"></td>
  <td><input type="text" inputmode="numeric" class="calcInput" id="res2_5Absorbed" placeholder="数値入力"></td>
  <td class="result" id="res2_5Result">計算中</td>
</tr>
</table>
</div>

<script>
const v=id=>document.getElementById(id).value;
const n=id=>Number(v(id));

function calcIf(ids, fn, out){
  if(ids.some(id=>v(id)==="")){
    out.textContent="計算中"; return;
  }
  out.textContent=fn();
}

// LP
function updateLP1(){
  calcIf(["lp1Absorber","lp1Absorbed"],
    ()=>Math.round(Math.pow(n("lp1Absorber")**2*n("lp1Absorbed"),0.333)), lp1Result);
}
function updateLP2(){
  calcIf(["lp2Absorber","lp2ResultInput"],
    ()=>Math.ceil(Math.pow(n("lp2ResultInput")-0.499,3.003)/(n("lp2Absorber")**2)), lp2Absorbed);
}
function updateLP3(){
  calcIf(["lp3Absorbed","lp3ResultInput"],
    ()=>Math.ceil(Math.sqrt(Math.pow(n("lp3ResultInput")-0.499,3.003)/n("lp3Absorbed"))), lp3Absorber);
}

// 耐性
function updateRes1(){
  calcIf(["res1Absorber","res1Absorbed"],
    ()=>Math.round(Math.pow((n("res1Absorber")+1000)**2*(n("res1Absorbed")+1000),0.333)-1000), res1Result);
}
function updateRes2(){
  calcIf(["res2Absorber","res2ResultInput"],
    ()=>Math.ceil(Math.pow(n("res2ResultInput")+1000,3.003)/((n("res2Absorber")+1000)**2)-1000), res2Absorbed);
}
function updateRes3(){
  calcIf(["res3Absorbed","res3ResultInput"],
    ()=>Math.ceil(Math.sqrt(Math.pow(n("res3ResultInput")+1000,3.003)/(n("res3Absorbed")+1000))-1000), res3Absorber);
}

// 耐性Ⅱ
["res2_1","res2_2","res2_3","res2_4","res2_5"].forEach(id=>{
  window["u_"+id]=()=>{
    calcIf([`${id}Absorber`,`${id}Absorbed`],
      ()=>Math.round(Math.pow((n(`${id}Absorber`)+1000)**2*(n(`${id}Absorbed`)+1000),0.333)-1000),
      document.getElementById(`${id}Result`));
  };
});

document.querySelectorAll("input").forEach(el=>{
  el.addEventListener("input",()=>{
    updateLP1(); updateLP2(); updateLP3();
    updateRes1(); updateRes2(); updateRes3();
    ["res2_1","res2_2","res2_3","res2_4","res2_5"].forEach(id=>window["u_"+id]());
  });
});
</script>

</body>
</html>
