<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>レベル技判定君</title>

<style>
* { box-sizing: border-box; }

body {
  font-family: system-ui, -apple-system;
  background: #1e1e2f;
  color: #fff;
  margin: 0;
  padding: 12px;
}

h1, h2 {
  text-align: center;
  margin-bottom: 10px;
}

/* パネル */
.panel {
  background: #2b2b44;
  padding: 8px;
  border-radius: 8px;
  margin-bottom: 12px;
  width: 100%;
  overflow-x: hidden;
}

/* テーブル */
table {
  border-collapse: collapse;
  width: 100%;
  background: #2b2b44;
  font-size: 11px;
  table-layout: fixed;
}

th, td {
  border: 1px solid #555;
  padding: 4px;
  text-align: center;
  word-wrap: break-word;
}

/* ヘッダー色 */
th { background: #3a3a5a; }

/* 入力欄 */
input.lvInput {
  width: 100%;
  max-width: 50px;
  background: #1e1e2f;
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: 4px;
  text-align: center;
  font-size: 12px;
}

/* 判定文字色 */
.hitText { color: #ff4444; font-weight: bold; }
.missText { color: #66ccff; }
.waitText { color: #aaa; }

/* ヘッダー内改行とチェックボックス */
th label {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  font-size: 10px;
}

/* ノート */
.note {
  margin-top: 4px;
  margin-bottom: 6px;
  font-size: 11px;
  color: #ccc;
  text-align: center;
}

/* レスポンシブ */
@media (max-width: 480px) {
  table { font-size: 10px; }
  input.lvInput { padding: 2px; font-size: 10px; }
}
</style>
</head>

<body>

<h1>レベル技判定君</h1>

<!-- 任意入力表 -->
<div class="panel">
  <table>
    <thead>
      <tr>
        <th>LV</th>
        <th>Lv2<br>毒</th>
        <th>Lv3<br>技封印</th>
        <th>Lv4<br>凍結</th>
        <th>Lv5<br>ｸｫｰﾀｰ</th>
        <th>Lv7<br>ﾌﾚｱｰ</th>
      </tr>
    </thead>
    <tbody id="inputTable"></tbody>
  </table>
</div>

<h2>レベル技対応表（Lv400～800）</h2>
<div class="note">
  チェックを入れると回避レベルのみ表示できます。
</div>

<div class="panel">
  <table id="skillTable">
    <thead>
      <tr>
        <th>LV</th>
        <th>
          Lv2<br>毒
          <label><input type="checkbox" data-mod="2"></label>
        </th>
        <th>
          Lv3<br>技封印
          <label><input type="checkbox" data-mod="3"></label>
        </th>
        <th>
          Lv4<br>凍結
          <label><input type="checkbox" data-mod="4"></label>
        </th>
        <th>
          Lv5<br>ｸｫｰﾀｰ
          <label><input type="checkbox" data-mod="5"></label>
        </th>
        <th>
          Lv7<br>ﾌﾚｱｰ
          <label><input type="checkbox" data-mod="7"></label>
        </th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
const skills = [
  { mod: 2, text: "毒" },
  { mod: 3, text: "技封印" },
  { mod: 4, text: "凍結" },
  { mod: 5, text: "ｸｫｰﾀｰ" },
  { mod: 7, text: "ﾌﾚｱｰ" }
];

/* 任意入力表 初期生成 */
function createInputTable(rows = 4) {
  const tb = document.getElementById("inputTable");
  tb.innerHTML = "";

  for (let i = 0; i < rows; i++) {
    const tr = document.createElement("tr");

    const tdLv = document.createElement("td");
    const input = document.createElement("input");
    input.type = "number";
    input.min = 0;
    input.max = 999;
    input.className = "lvInput";
    tdLv.appendChild(input);
    tr.appendChild(tdLv);

    skills.forEach(() => {
      const td = document.createElement("td");
      td.textContent = "判定中";
      td.className = "waitText";
      tr.appendChild(td);
    });

    tb.appendChild(tr);
  }

  document.querySelectorAll(".lvInput").forEach(input => {
    input.addEventListener("input", updateInputTable);
  });
}

/* 任意入力判定 */
function updateInputTable() {
  document.querySelectorAll("#inputTable tr").forEach(tr => {
    const input = tr.querySelector("input");
    const lv = Number(input.value);
    const tds = tr.querySelectorAll("td");

    skills.forEach((s, i) => {
      const cell = tds[i + 1];
      if (!input.value) {
        cell.textContent = "判定中";
        cell.className = "waitText";
      } else if (lv % s.mod === 0) {
        cell.textContent = s.text;
        cell.className = "hitText";
      } else {
        cell.textContent = "ミス";
        cell.className = "missText";
      }
    });
  });
}

/* 下表生成 */
function createMainTable() {
  const tbody = document.querySelector("#skillTable tbody");
  tbody.innerHTML = "";

  for (let lv = 400; lv <= 800; lv++) {
    const tr = document.createElement("tr");
    tr.dataset.lv = lv;

    const tdLv = document.createElement("td");
    tdLv.textContent = lv;
    tr.appendChild(tdLv);

    skills.forEach(s => {
      const td = document.createElement("td");
      if (lv % s.mod === 0) {
        td.textContent = s.text;
        td.className = "hitText";
      } else {
        td.textContent = "ミス";
        td.className = "missText";
      }
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  }
}

/* チェックボックスフィルタ */
function applyFilter() {
  const rules = [...document.querySelectorAll("th input")];
  document.querySelectorAll("#skillTable tbody tr").forEach(tr => {
    const lv = Number(tr.dataset.lv);
    const show = rules.every(r => !r.checked || lv % Number(r.dataset.mod) !== 0);
    tr.style.display = show ? "" : "none";
  });
}

document.querySelectorAll("th input").forEach(c => {
  c.addEventListener("change", applyFilter);
});

createInputTable();
createMainTable();
</script>

</body>
</html>
